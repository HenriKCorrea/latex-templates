name: Create Release

on:
  push:
    tags:
      - "v*.*.*" # Matches v1.0.0, v2.1.3, etc.
      - "v*.*.*-*" # Matches v1.0.0-alpha, v1.0.0-beta.1, etc.

jobs:
  create-release:
    runs-on: ubuntu-latest
    permissions:
      contents: write # Required for creating releases and uploading assets

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Archive texmf templates
        run: |
          tar -czf texmf-${{ github.ref_name }}.tar.gz texmf
          zip -r texmf-${{ github.ref_name }}.zip texmf

      - name: Create draft release with artifacts
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          gh release create "${{ github.ref_name }}" \
            texmf-${{ github.ref_name }}.tar.gz \
            texmf-${{ github.ref_name }}.zip \
            --draft \
            --title "LaTeX Templates ${{ github.ref_name }}" \
            --notes "## Release notes\n\nFill in details here."
